/*
 * Projekt SQL - propojení dat
 */ 

-- Primární tabulky:
-- czechia_payroll – Informace o mzdách v různých odvětvích za několikaleté období. Datová sada pochází z Portálu otevřených dat ČR.
-- czechia_payroll_calculation – Číselník kalkulací v tabulce mezd.
-- czechia_payroll_industry_branch – Číselník odvětví v tabulce mezd.
-- czechia_payroll_value_type  – Číselník jednotek hodnot v tabulce mezd.
-- czechia_payroll_value_type – Číselník typů hodnot v tabulce mezd.

SELECT 
	cp.id ,
	cp.value ,
-- 	cp.value_type_code ,
-- 	cpvt.code ,
	cpvt.name AS Kategorie_hodnoty,
-- 	cp.unit_code ,
-- 	cpu.code ,
	cpu.name AS Jednotka ,
-- 	cp.calculation_code ,
-- 	cpc.code ,
	cpc.name AS Ciselnik_kalkulaci_mezd ,
-- 	cp.industry_branch_code ,
-- 	cpib.code ,
	cpib.name AS Ciselník_odvetvi_mezd ,
	cp.payroll_year ,
	cp.payroll_quarter 
FROM czechia_payroll cp
LEFT JOIN czechia_payroll_calculation cpc
	ON cp.calculation_code = cpc.code
LEFT JOIN czechia_payroll_industry_branch cpib 	
	ON cp.industry_branch_code = cpib.code 
LEFT JOIN czechia_payroll_unit cpu 				
	ON cp.unit_code = cpu.code 
LEFT JOIN czechia_payroll_value_type cpvt 		
	ON cp.value_type_code = cpvt.code 
WHERE 1=1
ORDER BY  
	cp.payroll_year ,
	cp.industry_branch_code , 
	cpvt.name, 
	cpib.name ;
	

